{% extends 'base.html.twig' %}

{% block title %}Nauka - {{ category }}{% endblock %}

{% block stylesheets %}
<style>
    /* 3D Card Flip Animation */
    .card-container {
        perspective: 1000px;
        width: 100%;
        max-width: 600px;
        margin: 0 auto;
    }

    .card-flip {
        position: relative;
        width: 100%;
        min-height: 450px;
        transition: transform 0.6s;
        transform-style: preserve-3d;
    }

    .card-flip.flipped {
        transform: rotateY(180deg);
    }

    .card-face {
        position: absolute;
        width: 100%;
        min-height: 450px;
        backface-visibility: hidden;
        border-radius: 1rem;
        box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        background: white;
        display: flex;
        flex-direction: column;
        justify-content: center;
        padding: 2rem;
    }

    .card-back {
        transform: rotateY(180deg);
    }

    /* Progress bar smooth transition */
    .progress-bar {
        transition: width 0.5s ease-in-out;
    }

    /* Button hover effects */
    .btn-hover {
        transition: all 0.3s ease;
    }

    .btn-hover:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }

    /* Touch devices - remove hover effects */
    @media (hover: none) {
        .btn-hover:hover {
            transform: none;
        }
    }
</style>
{% endblock %}

{% block body %}
<div class="max-w-2xl mx-auto px-4 sm:px-6">
    {# Progress bar #}
    <div class="mb-8 sticky top-4 bg-white rounded-lg shadow-sm p-4 z-10">
        <div class="flex justify-between items-center mb-2">
            <span class="text-sm font-semibold text-gray-700">Postƒôp sesji</span>
            <span class="text-sm font-bold {% if category == 'programming' %}text-programming-600{% else %}text-travel-600{% endif %}">
                {{ current_index }}/{{ total_cards }} ({{ ((current_index / total_cards * 100)|round) }}%)
            </span>
        </div>
        <div class="w-full bg-gray-200 rounded-full h-3 overflow-hidden">
            <div class="progress-bar h-3 rounded-full bg-gradient-to-r {% if category == 'programming' %}from-programming-500 to-programming-600{% else %}from-travel-500 to-travel-600{% endif %}"
                 style="width: {{ (current_index / total_cards * 100)|round }}%"></div>
        </div>
    </div>

    {# Flashcard with 3D flip #}
    <div class="card-container mb-8">
        <div class="card-flip {% if show_answer %}flipped{% endif %}">
            {# Front side - Question #}
            <div class="card-face card-front">
                <div class="text-center">
                    <div class="mb-6">
                        <span class="inline-flex items-center px-4 py-2 text-sm font-bold rounded-full shadow-sm
                            {% if category == 'programming' %}bg-gradient-to-r from-programming-500 to-programming-600 text-white{% else %}bg-gradient-to-r from-travel-500 to-travel-600 text-white{% endif %}">
                            {% if category == 'programming' %}
                                üíª Programming
                            {% else %}
                                ‚úàÔ∏è Travel
                            {% endif %}
                        </span>
                    </div>

                    <h1 class="text-5xl sm:text-6xl font-bold text-gray-900 mb-12 leading-tight">
                        {{ word.word }}
                    </h1>

                    <form method="POST" action="{{ path('app_learn_show_answer') }}">
                        <button type="submit"
                                class="btn-hover px-10 py-4 text-lg {% if category == 'programming' %}bg-programming-600 hover:bg-programming-700{% else %}bg-travel-600 hover:bg-travel-700{% endif %} text-white rounded-xl font-semibold shadow-lg">
                            Poka≈º odpowied≈∫ üëÄ
                        </button>
                    </form>
                </div>
            </div>

            {# Back side - Answer #}
            <div class="card-face card-back">
                <div class="text-center h-full flex flex-col justify-between">
                    <div class="mb-6">
                        <span class="inline-flex items-center px-4 py-2 text-sm font-bold rounded-full shadow-sm
                            {% if category == 'programming' %}bg-gradient-to-r from-programming-500 to-programming-600 text-white{% else %}bg-gradient-to-r from-travel-500 to-travel-600 text-white{% endif %}">
                            {% if category == 'programming' %}
                                üíª Programming
                            {% else %}
                                ‚úàÔ∏è Travel
                            {% endif %}
                        </span>
                    </div>

                    <div class="flex-grow flex flex-col justify-center">
                        <h2 class="text-4xl font-bold text-gray-900 mb-2">
                            {{ word.word }}
                        </h2>

                        <div class="text-3xl font-semibold {% if category == 'programming' %}text-programming-700{% else %}text-travel-700{% endif %} mb-6">
                            {{ word.translation }}
                        </div>

                        {% if word.example %}
                            <div class="bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-5 mb-6 border-l-4 {% if category == 'programming' %}border-programming-500{% else %}border-travel-500{% endif %}">
                                <p class="text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2">Przyk≈Çad u≈ºycia</p>
                                <p class="text-base text-gray-800 italic leading-relaxed">"{{ word.example }}"</p>
                            </div>
                        {% endif %}
                    </div>

                    {# Review Buttons #}
                    <div class="flex flex-col sm:flex-row gap-3 justify-center mt-4">
                        <form method="POST" action="{{ path('app_learn_review', {quality: 'again'}) }}" class="flex-1">
                            <button type="submit"
                                    class="btn-hover w-full px-6 py-4 bg-red-600 hover:bg-red-700 text-white rounded-xl font-bold shadow-lg flex items-center justify-center gap-2 min-h-[56px]">
                                <span class="text-xl">‚ùå</span>
                                <span>Nie pamiƒôtam</span>
                            </button>
                        </form>

                        <form method="POST" action="{{ path('app_learn_review', {quality: 'good'}) }}" class="flex-1">
                            <button type="submit"
                                    class="btn-hover w-full px-6 py-4 bg-yellow-500 hover:bg-yellow-600 text-white rounded-xl font-bold shadow-lg flex items-center justify-center gap-2 min-h-[56px]">
                                <span class="text-xl">‚úì</span>
                                <span>Pamiƒôtam</span>
                            </button>
                        </form>

                        <form method="POST" action="{{ path('app_learn_review', {quality: 'easy'}) }}" class="flex-1">
                            <button type="submit"
                                    class="btn-hover w-full px-6 py-4 bg-green-600 hover:bg-green-700 text-white rounded-xl font-bold shadow-lg flex items-center justify-center gap-2 min-h-[56px]">
                                <span class="text-xl">‚ö°</span>
                                <span>≈Åatwe</span>
                            </button>
                        </form>
                    </div>

                    {# Status Info - z polskimi nazwami #}
                    <div class="mt-6 text-sm text-gray-500 space-y-1">
                        <p>Status: <span class="font-semibold {% if category == 'programming' %}text-programming-600{% else %}text-travel-600{% endif %}">
                            {% if progress.status.value == 'new' %}Nowy
                            {% elseif progress.status.value == 'learning' %}W nauce
                            {% else %}Opanowany{% endif %}
                        </span></p>
                        <p>Powt√≥rzenia: <span class="font-semibold">{{ progress.repetitions }}</span></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    {# Exit session button #}
    <div class="text-center">
        <a href="{{ path('app_dashboard') }}" class="text-gray-600 hover:text-gray-900 text-sm font-medium hover:underline">
            ‚Üê Zako≈Ñcz sesjƒô
        </a>
    </div>
</div>
{% endblock %}
